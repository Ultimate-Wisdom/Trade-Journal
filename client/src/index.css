@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --font-sans: 'Inter', sans-serif;
  --font-mono: 'JetBrains Mono', monospace;

  --radius-sm: calc(var(--radius) - 2px);
  --radius-md: var(--radius);
  --radius-lg: calc(var(--radius) + 2px);
  
  /* Unified Success Green - matches AdvancedStatistics text-green-500 (#22c55e) */
  --color-success-green: #22c55e;
  
  --color-background: hsl(var(--background));
  --color-foreground: hsl(var(--foreground));
  
  --color-card: hsl(var(--card));
  --color-card-foreground: hsl(var(--card-foreground));
  
  --color-popover: hsl(var(--popover));
  --color-popover-foreground: hsl(var(--popover-foreground));
  
  --color-primary: hsl(var(--primary));
  --color-primary-foreground: hsl(var(--primary-foreground));
  
  --color-secondary: hsl(var(--secondary));
  --color-secondary-foreground: hsl(var(--secondary-foreground));
  
  --color-muted: hsl(var(--muted));
  --color-muted-foreground: hsl(var(--muted-foreground));
  
  --color-accent: hsl(var(--accent));
  --color-accent-foreground: hsl(var(--accent-foreground));
  
  --color-destructive: hsl(var(--destructive));
  --color-destructive-foreground: hsl(var(--destructive-foreground));
  
  --color-border: hsl(var(--border));
  --color-input: hsl(var(--input));
  --color-ring: hsl(var(--ring));
  
  --color-chart-1: hsl(var(--chart-1));
  --color-chart-2: hsl(var(--chart-2));
  --color-chart-3: hsl(var(--chart-3));
  --color-chart-4: hsl(var(--chart-4));
  --color-chart-5: hsl(var(--chart-5));
  
  --color-sidebar: hsl(var(--sidebar));
  --color-sidebar-foreground: hsl(var(--sidebar-foreground));
  --color-sidebar-primary: hsl(var(--sidebar-primary));
  --color-sidebar-primary-foreground: hsl(var(--sidebar-primary-foreground));
  --color-sidebar-accent: hsl(var(--sidebar-accent));
  --color-sidebar-accent-foreground: hsl(var(--sidebar-accent-foreground));
  --color-sidebar-border: hsl(var(--sidebar-border));
  --color-sidebar-ring: hsl(var(--sidebar-ring));

  --color-profit: hsl(var(--profit));
  --color-loss: hsl(var(--loss));
}

/* Base layer reset */
@layer base {
  :root {
    /* Default to Dark Mode aesthetics for "Trading Terminal" feel */
    --background: 224 15% 8%; /* Very dark slate */
    --foreground: 210 20% 98%;

    --card: 224 15% 12%;
    --card-foreground: 210 20% 98%;

    --popover: 224 15% 12%;
    --popover-foreground: 210 20% 98%;

    --primary: 210 100% 60%; /* Electric Blue */
    --primary-foreground: 0 0% 100%;

    --secondary: 224 10% 20%;
    --secondary-foreground: 210 20% 98%;

    --muted: 224 10% 20%;
    --muted-foreground: 215 15% 65%;

    --accent: 210 100% 60%;
    --accent-foreground: 0 0% 100%;

    --destructive: 0 84% 60%;
    --destructive-foreground: 210 20% 98%;

    --border: 224 15% 20%;
    --input: 224 15% 20%;
    --ring: 210 100% 60%;

    --radius: 0.25rem; /* Sharp, technical feel */

    --chart-1: 210 100% 60%;
    --chart-2: 150 80% 40%;
    --chart-3: 0 84% 60%;
    --chart-4: 45 90% 60%;
    --chart-5: 280 70% 60%;

    --sidebar: 224 15% 10%;
    --sidebar-foreground: 210 20% 98%;
    --sidebar-primary: 210 100% 60%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 224 15% 15%;
    --sidebar-accent-foreground: 210 20% 98%;
    --sidebar-border: 224 15% 20%;
    --sidebar-ring: 210 100% 60%;
    
    --profit: 150 60% 45%; /* Green */
    --loss: 0 70% 50%; /* Red */
  }

  /* Force dark mode */
  .dark {
    --background: 224 15% 8%;
    --foreground: 210 20% 98%;
    --card: 224 15% 12%;
    --card-foreground: 210 20% 98%;
    --popover: 224 15% 12%;
    --popover-foreground: 210 20% 98%;
    --primary: 210 100% 60%;
    --primary-foreground: 0 0% 100%;
    --secondary: 224 10% 20%;
    --secondary-foreground: 210 20% 98%;
    --muted: 224 10% 20%;
    --muted-foreground: 215 15% 65%;
    --accent: 210 100% 60%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 210 20% 98%;
    --border: 224 15% 20%;
    --input: 224 15% 20%;
    --ring: 210 100% 60%;
    
    --profit: 150 60% 45%;
    --loss: 0 70% 50%;
  }

  * {
    @apply border-border;
  }
  body {
    @apply font-sans antialiased bg-background text-foreground;
    background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
    background-size: 40px 40px;
  }
}

/* Dark Mode Enhancements */
@layer utilities {
  /* Smooth transitions for theme changes */
  * {
    transition-property: background-color, border-color, color, fill, stroke;
    transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
    transition-duration: 200ms;
  }

  /* Enhanced card depth and glow */
  .card-enhanced {
    box-shadow: 
      0 0 0 1px hsl(var(--border)),
      0 4px 6px -1px rgba(0, 0, 0, 0.3),
      0 2px 4px -1px rgba(0, 0, 0, 0.2);
  }

  .card-enhanced:hover {
    box-shadow: 
      0 0 0 1px hsl(var(--primary) / 0.3),
      0 10px 15px -3px rgba(0, 0, 0, 0.4),
      0 4px 6px -2px rgba(0, 0, 0, 0.3),
      0 0 20px -5px hsl(var(--primary) / 0.15);
  }

  /* Primary glow effect */
  .glow-primary {
    text-shadow: 0 0 10px hsl(var(--primary) / 0.5);
  }

  .glow-primary-sm {
    box-shadow: 0 0 10px hsl(var(--primary) / 0.3);
  }

  /* Success (profit) glow */
  .glow-success {
    text-shadow: 0 0 10px hsl(var(--profit) / 0.5);
  }

  /* Danger (loss) glow */
  .glow-danger {
    text-shadow: 0 0 10px hsl(var(--loss) / 0.5);
  }

  /* Enhanced text contrast */
  .text-high-contrast {
    color: hsl(var(--foreground));
    font-weight: 500;
  }

  /* Enhanced button states */
  button, [role="button"] {
    transition: all 0.2s ease-in-out;
  }

  button:active, [role="button"]:active {
    transform: scale(0.98);
  }

  /* Enhanced focus rings */
  *:focus-visible {
    outline: 2px solid hsl(var(--primary));
    outline-offset: 2px;
    box-shadow: 0 0 0 4px hsl(var(--primary) / 0.1);
  }

  /* Scrollbar styling for dark mode */
  ::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  ::-webkit-scrollbar-track {
    background: hsl(var(--background));
  }

  ::-webkit-scrollbar-thumb {
    background: hsl(var(--muted));
    border-radius: 4px;
  }

  ::-webkit-scrollbar-thumb:hover {
    background: hsl(var(--muted-foreground) / 0.7);
  }

  /* Enhanced table rows */
  tr:hover {
    background-color: hsl(var(--muted) / 0.5);
  }

  /* Enhanced input fields */
  input:focus,
  textarea:focus,
  select:focus {
    border-color: hsl(var(--primary));
    box-shadow: 0 0 0 2px hsl(var(--primary) / 0.2);
  }

  /* Enhanced status indicators */
  .status-success {
    background-color: hsl(var(--profit) / 0.2);
    color: hsl(var(--profit));
    border: 1px solid hsl(var(--profit) / 0.3);
  }

  .status-danger {
    background-color: hsl(var(--loss) / 0.2);
    color: hsl(var(--loss));
    border: 1px solid hsl(var(--loss) / 0.3);
  }

  .status-warning {
    background-color: hsl(45 90% 60% / 0.2);
    color: hsl(45 90% 60%);
    border: 1px solid hsl(45 90% 60% / 0.3);
  }

  /* Enhanced chart container */
  .chart-container {
    background: linear-gradient(
      to bottom,
      hsl(var(--card)),
      hsl(var(--card) / 0.95)
    );
    border: 1px solid hsl(var(--border));
    box-shadow: 
      0 4px 6px -1px rgba(0, 0, 0, 0.2),
      0 2px 4px -1px rgba(0, 0, 0, 0.1);
  }

  /* Enhanced card header */
  .card-header-enhanced {
    border-bottom: 1px solid hsl(var(--border));
    background: linear-gradient(
      to bottom,
      hsl(var(--card)),
      hsl(var(--background) / 0.3)
    );
  }

  /* Glassmorphism effect */
  .glass {
    background: hsl(var(--card) / 0.7);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid hsl(var(--border) / 0.5);
  }

  /* Subtle animations */
  @keyframes pulse-glow {
    0%, 100% {
      box-shadow: 0 0 5px hsl(var(--primary) / 0.3);
    }
    50% {
      box-shadow: 0 0 20px hsl(var(--primary) / 0.5);
    }
  }

  .animate-pulse-glow {
    animation: pulse-glow 2s ease-in-out infinite;
  }

  /* Enhanced badge styling */
  .badge-enhanced {
    background: hsl(var(--primary) / 0.2);
    color: hsl(var(--primary));
    border: 1px solid hsl(var(--primary) / 0.3);
    text-shadow: 0 0 8px hsl(var(--primary) / 0.5);
  }

  /* Enhanced data visualization */
  .data-cell-positive {
    color: hsl(var(--profit));
    font-weight: 600;
    text-shadow: 0 0 8px hsl(var(--profit) / 0.3);
  }

  .data-cell-negative {
    color: hsl(var(--loss));
    font-weight: 600;
    text-shadow: 0 0 8px hsl(var(--loss) / 0.3);
  }

  /* Enhanced separator */
  .separator-enhanced {
    background: linear-gradient(
      to right,
      transparent,
      hsl(var(--border)),
      transparent
    );
    height: 1px;
  }

  /* Mobile Responsiveness Enhancements */
  @media (max-width: 768px) {
    /* Larger touch targets for mobile */
    button, [role="button"], a {
      min-height: 44px;
    }

    /* Better spacing on mobile */
    .mobile-spacing > * + * {
      margin-top: 1rem;
    }

    /* Prevent horizontal scroll */
    body, html {
      overflow-x: hidden;
      width: 100%;
    }
    
    #root {
      overflow-x: hidden;
      width: 100%;
    }

    /* Better text wrapping for long words */
    p, span, div {
      word-wrap: break-word;
      overflow-wrap: break-word;
    }
    
    /* Prevent code/monospace text overflow */
    code, pre, .font-mono {
      white-space: pre-wrap;
      word-break: break-word;
    }

    /* Better form inputs on mobile */
    input, textarea, select {
      font-size: 16px !important; /* Prevents zoom on iOS */
      max-width: 100%;
      box-sizing: border-box;
    }

    /* Mobile-optimized cards */
    .card-mobile {
      border-radius: 0.5rem;
      padding: 1rem;
    }

    /* Full-width buttons on mobile */
    .btn-mobile-full {
      width: 100% !important;
    }

    /* Better table scrolling - CRITICAL FOR MOBILE */
    .overflow-x-auto {
      overflow-x: auto !important;
      overflow-y: visible;
      -webkit-overflow-scrolling: touch;
      width: 100%;
      scroll-behavior: smooth;
    }
    
    /* Prevent table from overflowing viewport */
    table {
      width: 100%;
      display: table;
      table-layout: auto;
    }
    
    /* Ensure table cells don't wrap */
    td, th {
      white-space: nowrap !important;
      padding: 0.5rem 0.5rem;
      font-size: 0.875rem;
    }
    
    /* Compact badges on mobile */
    td .badge, td [class*="badge"] {
      font-size: 0.7rem;
      padding: 0.15rem 0.35rem;
    }
    
    /* Hide checkbox column on mobile (batch operations) */
    th:first-child, td:first-child {
      display: none;
    }

    /* Sticky mobile headers */
    .mobile-header-sticky {
      position: sticky;
      top: 0;
      z-index: 50;
      background: hsl(var(--background));
      border-bottom: 1px solid hsl(var(--border));
    }

    /* Mobile navigation optimization */
    .mobile-nav-item {
      padding: 0.75rem 1rem;
      min-height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Better modal sizing on mobile */
    [role="dialog"] {
      max-height: 90vh;
      overflow-y: auto;
    }

    /* Mobile-friendly badges */
    .badge-mobile {
      font-size: 0.75rem;
      padding: 0.25rem 0.5rem;
    }

    /* Improved tap highlights */
    * {
      -webkit-tap-highlight-color: hsl(var(--primary) / 0.2);
    }

    /* Better mobile grid layouts */
    .grid-mobile-1 {
      grid-template-columns: 1fr !important;
    }
    
    /* Responsive grids on mobile (3+ columns become 1 or 2) */
    /* BUT preserve explicit 2-column grids */
    [class*="grid-cols-3"]:not([class*="grid-cols-2"]),
    [class*="grid-cols-5"],
    [class*="grid-cols-6"] {
      grid-template-columns: 1fr !important;
    }

    /* FORCE 2x2 grid for stats cards on mobile - CRITICAL */
    /* Only target explicit grid-cols-2 (not responsive variants like lg:grid-cols-2) */
    .grid.grid-cols-2:not([class*="lg:grid-cols-2"]):not([class*="md:grid-cols-2"]):not([class*="sm:grid-cols-2"]) {
      display: grid !important;
      grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    }

    /* Prevent ANY grid override on 2-column layouts - but exclude responsive variants */
    [class*="grid"][class*="grid-cols-2"]:not([class*="lg:grid-cols-2"]):not([class*="md:grid-cols-2"]):not([class*="sm:grid-cols-2"]) {
      display: grid !important;
      grid-template-columns: repeat(2, minmax(0, 1fr)) !important;
    }
    
    /* Prevent flex items from overflowing */
    .flex > * {
      min-width: 0;
    }

    /* Prevent text overflow in cards */
    .card h3, .card p, [class*="card"] h3, [class*="card"] p {
      overflow-wrap: break-word;
      word-break: break-word;
      max-width: 100%;
    }

    /* Specifically handle card titles */
    [role="heading"], h1, h2, h3, h4, h5, h6 {
      overflow-wrap: break-word;
      word-break: break-word;
      hyphens: auto;
    }

    /* Ensure card content doesn't overflow */
    [class*="CardContent"], [class*="CardHeader"], [class*="CardTitle"] {
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Fix for long numbers in cards */
    .font-mono, [class*="font-mono"] {
      font-size: 0.9em; /* Slightly smaller for mobile */
      word-break: break-word; /* Changed from break-all to break-word */
    }

    /* NO GLOBAL TAB OVERRIDES - Let components control their own styles */

    /* FIX OVERLAPPING LABELS AND HEADINGS */
    label, [class*="Label"] {
      display: block !important;
      margin-bottom: 0.5rem !important;
      position: relative !important;
      z-index: 1 !important;
      background: transparent !important;
    }

    /* Ensure proper spacing in forms */
    .space-y-2 > * + *, [class*="space-y"] > * + * {
      margin-top: 0.75rem !important;
    }

    /* Fix absolute positioned elements overlapping */
    [class*="absolute"] {
      z-index: auto !important;
    }

    /* Prevent flex/grid items from overlapping */
    .flex > *, .grid > *, [class*="flex"] > *, [class*="grid"] > * {
      min-width: 0 !important;
      min-height: 0 !important;
    }

    /* Hide desktop-only elements */
    .desktop-only {
      display: none !important;
    }

    /* Show mobile-only elements */
    .mobile-only {
      display: block !important;
    }

    /* Better text readability on mobile */
    .text-mobile-lg {
      font-size: 1.125rem;
      line-height: 1.75rem;
    }
    
    /* Truncate long text on mobile */
    h1, h2, h3, h4, h5, h6 {
      word-break: break-word;
      overflow-wrap: break-word;
    }

    /* Improved mobile spacing */
    .px-mobile-safe {
      padding-left: max(1rem, env(safe-area-inset-left));
      padding-right: max(1rem, env(safe-area-inset-right));
    }

    .pb-mobile-safe {
      padding-bottom: max(1rem, env(safe-area-inset-bottom));
    }

    /* Better mobile stats cards */
    .stat-card-mobile {
      padding: 0.75rem;
      min-height: auto;
    }

    /* Compact card headers and content on mobile */
    [data-slot="card-header"] {
      padding: 0.75rem !important;
    }

    [data-slot="card-content"] {
      padding: 0.75rem !important;
    }

    /* Reduce all card padding on mobile */
    .card, [class*="card"] {
      padding: 0;
    }

    /* Reduce margin/spacing on mobile - AGGRESSIVE */
    .mb-3, .mb-4, .mb-6, .mb-8 {
      margin-bottom: 0.75rem !important;
    }

    .mt-3, .mt-4, .mt-6, .mt-8 {
      margin-top: 0.75rem !important;
    }

    .gap-3, .gap-4, .gap-6 {
      gap: 0.75rem !important;
    }

    /* Tighter grid layout on mobile */
    main {
      padding-left: 0.75rem !important;
      padding-right: 0.75rem !important;
    }

    /* Optimized mobile charts */
    .chart-mobile {
      height: 200px !important;
    }

    /* Better mobile dropdowns */
    [role="listbox"], [role="menu"] {
      max-height: 60vh;
      overflow-y: auto;
    }
  }

  /* Tablet-specific optimizations */
  @media (min-width: 768px) and (max-width: 1024px) {
    .tablet-grid-2 {
      grid-template-columns: repeat(2, 1fr);
    }

    .tablet-hidden {
      display: none !important;
    }
  }

  /* Safe area support for devices with notches */
  @supports (padding: max(0px)) {
    .safe-top {
      padding-top: max(1rem, env(safe-area-inset-top));
    }

    .safe-bottom {
      padding-bottom: max(1rem, env(safe-area-inset-bottom));
    }

    .safe-left {
      padding-left: max(1rem, env(safe-area-inset-left));
    }

    .safe-right {
      padding-right: max(1rem, env(safe-area-inset-right));
    }
  }

  /* Better mobile scrolling */
  .mobile-scroll-smooth {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  /* Mobile-optimized images */
  @media (max-width: 768px) {
    img {
      max-width: 100%;
      height: auto;
    }
  }

  /* Prevent text selection on buttons (better mobile UX) */
  button, [role="button"] {
    user-select: none;
    -webkit-user-select: none;
  }

  /* Better mobile focus states */
  @media (max-width: 768px) {
    *:focus-visible {
      outline: 3px solid hsl(var(--primary));
      outline-offset: 3px;
    }
    
    /* Better mobile dialog positioning */
    [role="dialog"] {
      margin: 1rem;
      max-width: calc(100vw - 2rem);
    }
  }
}

/* Safety override for text wrapping */
p, div {
  overflow-wrap: break-word;
  word-break: normal;
}